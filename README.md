# Generate Scavenger Cluster Metrics

MoveApps

Github repository: *github.com/callumjclarke/Generate_Scavenger_Cluster_Metrics*

## Description

This MoveApp operates on the output of a cluster-detection MoveApp [for now, either **ST-DBSCAN Clustering** or **Avian Cluster Detection**] to generate key cluster statistics. This MoveApp is intended primarily for mammalian scavengers, but the generated attributes can be calculated for any species.

## Documentation

This MoveApp requires, as input, a move2 location object with appended column **xy.clust** attributing each location to a cluster (or an NA-value for non-cluster locations). It additionally requires that sunrise- and sunset-timestamps are appended using the **Add Local and Solar Time** MoveApp earlier in the workflow (i.e. instant-columns named *sunrise_timestamp, sunset_timestamp*).

A 'clustertable', with one entry per cluster, is generated detailing several key cluster attributes:

1.  *ntags:* The number of individual IDs associated with this cluster.
2.  *tags:* a character list of the above tags.
3.  *firstdatetime, lastdatetime:* The earliest and latest timestamp of locations associated with this event.
4.  *days:* The total number of **unique days** on which this cluster was 'active' (i.e. visited by at least one tag).
5.  *totaldays:* The *total duration* of the event, calculated as the difference between *firstdatetime* and *lastdatetime* in days.
6.  *daysempty:* The number of days within *totaldays* on which the cluster was not visited. That is, the difference between *totaldays* and *days. daysemptyprop* gives this as a proportion of total duration.
7.  *Total:* The total number of individual locations associated with this cluster.
8.  *totalhrs:* The summed time-lags of every associated location within this cluster, intended as a proxy for time-spent at the cluster.
9.  *totalhrs_daytime:* The length of time within *totalhrs* that takes place during daytime, as defined by *sunrise_timestamp, sunset_timestamp.* This is also given as a proportion of *totalhrs* in the next column, *dayprop.*
10. *sleepspots:* The number of 'Sleeping Events' associated with this cluster. A 'Sleeping Event' is defined as a period of stationary behaviour, occuring within one day, longer in duration than input parameter **Sleeping Duration,** with a distance-from-cluster shorter than input parameter **Sleeping Distance.**
11. *mean_visit_duration:* The mean duration of a 'visit' to this cluster.
12. *nrevisits:* The total number of unique visits to this cluster, by any ID.
13. *mean_revisit_time:* The mean time elapsed between visits to this cluster by any ID. If no revisits are recorded for this cluster (i.e. `nrevisits = 0`, this value is *NA).*

The output consists of:

-   The input tracking data (unchanged) with

    -   The clustertable attached as an **attribute,** accessible by calling `attr(output, "cluster_tbl")`

### Input data

*move2* location object with 3 required columns:

-   *xy.clust,* generated by **ST-DBSCAN Clustering** or **Avian Cluster Detection**

-   *sunrise_timestamp* and *sunset_timestamp,* generated by **Add Local and Solar Time**

### Output data

*move2* location object with clustertable appended as an attribute, accessible by `attr(output, "cluster_tbl")`

### Artefacts

### Settings

-   `Minimum Duration of Sleeping Behaviour:` The shortest duration of stationary behaviour, in hours, that can be classified as a "sleeping event". Make sure that this is longer in duration than the location sampling frequency. Defaults to 4 hours.

-   `Assignment Distance for Sleepspots:` The maximum proximity (in metres) from a cluster at which a sleepspot will be "assigned" to that cluster. Defaults to 250m.

-   `Maximum Distance of Movement for Stationary Classification:` The greatest distance travelled (in metres) between two locations below which the first location will be given a 'stationary' classification. This stationary classification is used in sleepspot identification. Defaults to 25m.

### Most common errors

### Null or error handling
